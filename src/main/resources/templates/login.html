<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Login Page</title>
  <link th:href="'https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css'" th:rel="'stylesheet'">
  <link href="/css/login.css">
<!--  <script src="/js/postRequest.js"></script>-->
</head>
<body>

<h1>AJAX POST Request Example</h1>
<div>
  <label for="email">Enter email:</label>
  <input type="email" id="email" />
  <br>
  <label for="password">Enter password:</label>
  <input type="password" id="password" />
  <br>
  <button onclick="sendData()">Send Data</button>
</div>
<script>
  function sendData() {
    const inputEmail = document.getElementById("email");
    const inputPassword = document.getElementById("password");

    const userCredentials = {
      email: inputEmail.value,
      password: inputPassword.value
    };

    console.log(userCredentials);

    // Create an object with the data you want to send
    // const requestData = {
    //     data: data
    // };

    // Perform the AJAX POST request
    fetch("/api/v1/auth/authenticate", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        'Authorization': 'True'
      },
      body: JSON.stringify(userCredentials)
    })
            .then(response => {
              if (!response.ok) {
                throw new Error("Network response was not ok");
              }
              return response.json();
            })
            .then(data => {
              // Handle the response from the server

              console.log("Response from server:", data);
              localStorage.setItem('role', data.role);
              localStorage.setItem('jwtToken', data.accessToken);
              localStorage.setItem("username", data.username);
              redirectToHomePage('/page');
            })
            .catch(error => {
              // Handle any errors that occurred during the request
              console.error("Error:", error);
            });
  }
  function redirectToHomePage(url) {
    // Redirect to the home page
    window.location.href = url;
  }
</script>


<script th:src="'https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.0/jquery.min.js'" th:integrity="'sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ='" th:crossorigin="'anonymous'"></script>
<script th:src="'https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js'"></script>
<script th:src="'https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js'"></script>
<script th:src="'https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js'"></script>
</body>
</html>